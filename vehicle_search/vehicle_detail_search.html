<!DOCTYPE html>
<html>
<head>
	<title>Firebase Search Demo</title>
	<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
   <link rel="stylesheet" href="/css/index.css">
   <link rel="stylesheet" href="/index.css">
   <link rel="stylesheet" href="/css/bootstrap.min.css">
   <script src="/js/bootstrap.bundle.min.js"></script>
</head>
<body>
	<nav>
		<div class="container">
		  <a class="logo" href="#">Power Fuel</a>
		  <ul class="nav-links">
			<li><a href="/index.html">Home</a></li>
			<li><a href="/register_vehicle.html">Register Vehicle</a></li>
			<li><a href="vehicle_detail_search.html">Search Vehicle</a></li>
		  </ul>
		  <div class="burger">
			<div class="line"></div>
			<div class="line"></div>
			<div class="line"></div>
		  </div>
		</div>
	  </nav>
	<main>
	<h1>Search Your Vehicle</h1>
   <div class="mb-3">
      <label for="exampleInput" class="form-label">Token Number</label>
	<input class="form-control" type="text" id="userId" placeholder="Enter Token Number">
   </div>
	<button class="btn btn-success" onclick="searchUser()">Search</button> <br>

   <div class="mb-3">
	<div id="vehicle-list"></div>
   </div>
</main>
</body>
</html>




<script>
	// Your Firebase configuration
	var firebaseConfig = {
		apiKey: "AIzaSyAebGvZhL7hQLLllFF8Bm7iKyqT7FIyk-I",
		authDomain: "loginauth-38206.firebaseapp.com",
	databaseURL: "https://loginauth-38206-default-rtdb.firebaseio.com/",
	projectId: "loginauth-38206",
	storageBucket: "loginauth-38206.appspot.com",
	messagingSenderId: "479003296642",
	appId: "1:479003296642:web:20b63baf55a2ab0b12459b"
	};

	// Initialize Firebase
	firebase.initializeApp(firebaseConfig);

	var ref = firebase.database().ref("vehicleData");
	var vehicleList = document.getElementById("vehicle-list");

	function searchUser() {
		var userId = document.getElementById("userId").value;
		var helloWorld = parseInt(userId);

		// Clear any existing data from the list
		vehicleList.innerHTML = "";

		if(!userId) {
			Swal.fire({
				icon: "error",
				title: "Error",
				text: "Please enter a token number"
			});
			return;
		}

		ref.orderByChild("tokenNumber").equalTo(helloWorld).on("value", function(snapshot) {

			if(snapshot.exists()) {
			snapshot.forEach(function(childSnapshot) {
				var childKey = childSnapshot.key;
				var childData = childSnapshot.val();
				var tokenNumber = childData.tokenNumber;
				var fuelAllocation = childData.fuelAllocation;
				var fuelLevel = childData.fuelLevel;
				var fuelType = childData.fuelType;
				var vehicleNumber = childData.vehicleNumber;
				var vehicleType = childData.vehicleType;

				// Create the HTML for the new list item
				var listItemHtml = '<div class="vehicle-item form-control">' +
					'<h3 class="text-center text-danger">Token Number: ' + tokenNumber + '</h3>' +
					'<p class="fw-bold fs-5">Fuel Allocation: <span class="fw-normal">' + fuelAllocation + ' </span> </p>' +
					'<p class="fw-bold fs-5">Fuel Level: <span class="fw-normal">' + fuelLevel + '</span> </p>' +
					'<p class="fw-bold fs-5">Fuel Type: <span class="fw-normal">' + fuelType +  ' </span> </p>' +
					'<p class="fw-bold fs-5">Vehicle Number: <span class="fw-normal">' + vehicleNumber + '</span> </p>' +
					'<p class="fw-bold fs-5">Vehicle Type: <span class="fw-normal">' + vehicleType + '</span> </p>' +
				'</div>';
				// Append the new HTML to the vehicle list
				vehicleList.insertAdjacentHTML('beforeend', listItemHtml);
			});
		} else {
            Swal.fire({
                icon: "error",
                title: "Oops...",
                text: "Give token number is invalid. Please check again!"
            });
        }
		
	});
	}
</script>